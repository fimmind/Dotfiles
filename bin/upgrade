#!/usr/bin/env bash
sudo_upgrade(){
  pacman-key --refresh-keys
  pacman -Syyuu --noconfirm
  tlmgr update --self --all --reinstall-forcibly-removed
  pamac update --no-confirm
  npm upgrade
  updatedb
}

no_sudo_upgrade(){
  brew update
  brew upgrade
  stack upgrade

  cd ~/Dotfiles
  nvim -u "nvim/plugins.vim" -c ":UpdateVimPlug | :PlugUpdate | :qa"
}

printf "Do you want to start full system upgrade? (y/n) "
read answer

if [[ -z "$answer" ]] || [[ "$answer" == "y" ]]; then
  cd ~
  sudo bash -c "$(declare -f sudo_upgrade); sudo_upgrade"
  no_sudo_upgrade
fi
