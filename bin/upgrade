#!/usr/bin/env bash
sudo_upgrade(){
  pacman-key --refresh-keys
  pacman -Syyuu --noconfirm
  tlmgr update --self --all --reinstall-forcibly-removed
  pamac update --no-confirm
  npm upgrade
  updatedb
}

no_sudo_upgrade(){
  brew update
  brew upgrade
  stack upgrade

  nvim -u "~/Dotfiles/nvim/plugins.vim" -c "call UpdateVimPlug() | :PlugUpdate | :qa"
}

if zenity --question --text "Do you want to start full system upgrade?"; then
  cd ~
  zenity --password | sudo -S bash -c "$(declare -f sudo_upgrade); sudo_upgrade"
  no_sudo_upgrade
fi
